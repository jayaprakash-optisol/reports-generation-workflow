### AI Report Generator - API Testing
### Use with REST Client extension in VS Code / Cursor

@baseUrl = http://localhost:3000/api

### ============================================
### Health Check
### ============================================

GET {{baseUrl}}/health

### ============================================
### Create Business Report (JSON Data)
### ============================================

POST {{baseUrl}}/reports
Content-Type: application/json

{
  "data": [
    {
      "type": "structured",
      "format": "json",
      "data": [
        {"month": "January", "revenue": 125000, "expenses": 98000, "customers": 1250, "region": "North"},
        {"month": "January", "revenue": 98000, "expenses": 76000, "customers": 980, "region": "South"},
        {"month": "February", "revenue": 132000, "expenses": 102000, "customers": 1320, "region": "North"},
        {"month": "February", "revenue": 105000, "expenses": 82000, "customers": 1050, "region": "South"},
        {"month": "March", "revenue": 145000, "expenses": 108000, "customers": 1420, "region": "North"},
        {"month": "March", "revenue": 112000, "expenses": 88000, "customers": 1100, "region": "South"}
      ]
    },
    {
      "type": "unstructured",
      "format": "text",
      "content": "Q1 Performance Notes: The North region continues to show strong growth momentum. Customer retention rates improved to 94% across all regions. Focus areas for next quarter include expanding enterprise sales and launching customer loyalty programs."
    }
  ],
  "config": {
    "title": "Q1 2024 Business Performance Report",
    "style": "business",
    "outputFormats": ["PDF", "HTML"],
    "branding": {
      "primaryColor": "#1a365d",
      "secondaryColor": "#2b6cb0",
      "accentColor": "#ed8936",
      "companyName": "Acme Corporation"
    }
  }
}

### ============================================
### Create Technical Report
### ============================================

POST {{baseUrl}}/reports
Content-Type: application/json

{
  "data": [
    {
      "type": "structured",
      "format": "json",
      "data": [
        {"timestamp": "2024-06-01T08:00:00Z", "requests": 25640, "errors": 78, "latency_p50": 175, "latency_p99": 680, "cpu_usage": 72},
        {"timestamp": "2024-06-01T09:00:00Z", "requests": 32450, "errors": 125, "latency_p50": 210, "latency_p99": 850, "cpu_usage": 85},
        {"timestamp": "2024-06-01T10:00:00Z", "requests": 35820, "errors": 142, "latency_p50": 235, "latency_p99": 920, "cpu_usage": 92},
        {"timestamp": "2024-06-01T11:00:00Z", "requests": 34560, "errors": 138, "latency_p50": 225, "latency_p99": 890, "cpu_usage": 88},
        {"timestamp": "2024-06-01T12:00:00Z", "requests": 28940, "errors": 95, "latency_p50": 185, "latency_p99": 720, "cpu_usage": 75}
      ]
    },
    {
      "type": "unstructured",
      "format": "text",
      "content": "Incident at 10:15 AM: Brief latency spike due to database connection pool exhaustion. Resolution: Increased pool size from 50 to 100. Root cause: Traffic surge from marketing campaign."
    }
  ],
  "config": {
    "title": "System Performance Report - June 2024",
    "style": "technical",
    "outputFormats": ["PDF", "HTML"]
  }
}

### ============================================
### Create Research Report
### ============================================

POST {{baseUrl}}/reports
Content-Type: application/json

{
  "data": [
    {
      "type": "structured",
      "format": "json",
      "data": [
        {"participant_id": "P001", "age": 34, "treatment_group": "A", "baseline_score": 45, "week12_score": 68},
        {"participant_id": "P002", "age": 28, "treatment_group": "B", "baseline_score": 42, "week12_score": 48},
        {"participant_id": "P003", "age": 45, "treatment_group": "A", "baseline_score": 38, "week12_score": 62},
        {"participant_id": "P004", "age": 52, "treatment_group": "B", "baseline_score": 51, "week12_score": 55},
        {"participant_id": "P005", "age": 31, "treatment_group": "A", "baseline_score": 40, "week12_score": 65},
        {"participant_id": "P006", "age": 39, "treatment_group": "B", "baseline_score": 47, "week12_score": 51}
      ]
    },
    {
      "type": "unstructured",
      "format": "markdown",
      "content": "## Study Background\n\nThis RCT investigates the efficacy of Treatment Protocol A compared to Standard Care (Group B) for cognitive enhancement.\n\n### Methodology\n- Study Design: Double-blind, placebo-controlled\n- Duration: 12 weeks\n- Primary Outcome: Cognitive Assessment Score (CAS)"
    }
  ],
  "config": {
    "title": "Cognitive Enhancement Protocol: A Randomized Controlled Trial",
    "style": "research",
    "outputFormats": ["PDF", "DOCX"],
    "authorName": "Dr. Jane Smith, Ph.D."
  }
}

### ============================================
### Create Report with CSV Data
### ============================================

POST {{baseUrl}}/reports
Content-Type: application/json

{
  "data": [
    {
      "type": "structured",
      "format": "csv",
      "data": "date,product,sales,units\n2024-01-01,Widget A,15000,150\n2024-01-01,Widget B,12000,120\n2024-01-02,Widget A,16500,165\n2024-01-02,Widget B,13200,132\n2024-01-03,Widget A,14800,148\n2024-01-03,Widget B,11500,115"
    }
  ],
  "config": {
    "title": "Product Sales Analysis",
    "style": "business",
    "outputFormats": ["PDF"]
  }
}

### ============================================
### Create Report with Excel Data (Base64 encoded)
### Note: For file upload, use the /reports/upload endpoint with multipart/form-data
### This example shows the JSON API with base64-encoded Excel data
### ============================================

# To test Excel upload via multipart/form-data, use curl:
# curl -X POST http://localhost:3000/api/reports/upload \
#   -F "files=@data.xlsx" \
#   -F "title=Excel Sales Report" \
#   -F "style=business" \
#   -F "outputFormats=PDF,HTML"

### ============================================
### Get Report Status
### Replace {reportId} with actual ID from create response
### ============================================

@reportId = TqTi8Aulinc-

GET {{baseUrl}}/reports/{{reportId}}

### ============================================
### List All Reports
### ============================================

GET {{baseUrl}}/reports

### ============================================
### Download PDF
### Replace {reportId} with actual ID
### ============================================

GET {{baseUrl}}/reports/{{reportId}}/files?format=PDF

### ============================================
### Download HTML
### Replace {reportId} with actual ID
### ============================================

GET {{baseUrl}}/reports/{{reportId}}/files?format=HTML

### ============================================
### Download DOCX
### Replace {reportId} with actual ID
### ============================================

GET {{baseUrl}}/reports/{{reportId}}/files?format=DOCX

### ============================================
### Cancel Report Generation
### Replace {reportId} with actual ID
### ============================================

POST {{baseUrl}}/reports/{{reportId}}/cancel

### ============================================
### Wait for Report Completion (blocking)
### Replace {reportId} with actual ID
### ============================================

GET {{baseUrl}}/reports/{{reportId}}/wait

